---
title: Take Ownership
description: Take ownership of your 1FE app by customizing the default plugin and hosting it on a CDN.
sidebar:
  order: 3
---

import { SlCloudDownload, SlPencil, SlRocket } from "react-icons/sl";
import { FcOk } from "react-icons/fc";

Let's customize your new 1FE app by making changes to the default plugin! Since 1FE is powered by CDN, we will update and build the plugin and host the assets.

## <SlPencil style={{ display: 'inline', marginRight: '0.5rem', verticalAlign: 'middle' }} /> Setup your plugins

##### 1. Make any content change to `1fe-widget-starter-kit/src`

```tsx title="1fe-widget-starter-kit/src/app1.tsx" {10}
import { platformProps } from '@devhub/1fe-shell';
import React, { useEffect } from 'react';
import { Router as Widget } from './components/router';
import { withProvider } from './withProvider';
import { WidgetProps } from './contract';

const RootWrapper: React.FC<WidgetProps> = (props) => {
  useEffect(() => {
    platformProps.utils.appLoadTime.end();
    console.log('Hello from app1!');
  }, []);

  return <Widget {...props} />;
};

export default withProvider(RootWrapper);

```

##### 2. Build the plugin within `1fe-widget-starter-kit` directory

:::caution
**Keep your 1FE app running in the background**.

1FE CLI will need the development server for the build process. This will later be pointed to a deployed environment once your 1FE app is hosted.
:::

```bash
# 1fe
cd 1fe-widget-starter-kit
yarn build:widget
```

:::tip
1FE CLI will build the widget. Observe the assets within the `dist` folder.
:::

  ![dist folder contents](./assets/example-plugin-dist.png)

##### 3. Setup the bathtub widget

We'll also need the bathtub widget for our 1FE application. The bathtub widget provides essential development tooling and runtime utilities.

1. Fork the [1fe-bathtub](https://github.com/docusign/1fe-bathtub) repository to your GitHub account.

```bash
git clone https://github.com/<your-github-username>/1fe-bathtub.git
cd 1fe-bathtub
```

2. Install dependencies and build the widget:

```bash
yarn install
yarn build:widget
```

:::tip
The bathtub widget build will generate assets in the `dist` folder that we'll upload to our CDN later.
:::


## <SlCloudDownload style={{ display: 'inline', marginRight: '0.5rem', verticalAlign: 'middle' }} /> "Setup" your CDN

To get started quickly, we will use jsdelivr CDN to host the needed assets.

##### 1. Fork this [mock-cdn-assets](https://github.com/docusign/mock-cdn-assets/tree/main) repository
This repository contains the live configurations and widget assets per environment that power [demo.1fe.com](https://demo.1fe.com). We will use this as a jumping off point to get our own version of the assets and rely on [jsdelivr](https://www.jsdelivr.com/) to act as a CDN to start powering our application.


## <SlCloudDownload style={{ display: 'inline', marginRight: '0.5rem', verticalAlign: 'middle' }} /> "Deploy" your plugins to CDN

We will host the plugin assets using our forked repo from the previous step to make them accessible to the 1FE app. This allows for dynamic loading of widgets and plugins.

##### 1. Upload widget assets

<div className="prose">
1. Create a new directory within `integration/widgets/@1fe/widget-starter-kit` of your forked cdn repo. The directory name should be the version from the package.json of the widget-starter-kit repository. (e.g `1.0.2`).

2. Upload the contents of the `1fe-widget-starter-kit/dist/` directory to the new directory.

3. Create a new directory within `integration/widgets/@1fe/bathtub` of your forked cdn repo. The directory name should be the version from the package.json of the bathtub repository (e.g `1.0.50`).

4. Upload the contents of the `1fe-bathtub/dist/` directory to the bathtub directory.
![dist folder assets copied to CDN](./assets/example-plugin-cdn-assets.png)

5. Push these changes to your forked repository.

6. Create and push a tag. This is important for JSdelivr to cache the assets properly.
```
git tag v1.0.2
git push origin v1.0.2
```

6. Confirm that the assets are publicly accessible by visiting these jsdelivr cdn locations. Replace with your gh username and versions:
```
https://cdn.jsdelivr.net/gh/<your-github-username>/<repo-name>@<tag>/integration/widgets/@1fe/widget-starter-kit/<version>/js/1fe-bundle.js
https://cdn.jsdelivr.net/gh/<your-github-username>/<repo-name>@<tag>/integration/widgets/@1fe/bathtub/<version>/js/1fe-bundle.js
```

An example URL would look like this:
```
https://cdn.jsdelivr.net/gh/mohit-test-org/1fe-mock-cdn-assets@v1.0.2/integration/widgets/@1fe/bathtub/1.0.50/js/1fe-bundle.js
```

</div>

##### 2. Update the live configs

One of the key features of 1FE is the ability to dynamically load widgets and plugins via [Live Configurations](../../main-concepts/live-configurations). We will now update the Live Configurations to point to our new plugin assets.

###### Update widget-versions.json

The `widget-versions.json` file defines the available versions for each widget that can be loaded by the 1FE platform.

1. Create `integration/configs/widget-versions.json` file within your forked mock-cdn-assets repository and update it like so:
```json title="widget-versions.json"
[
  {
    "widgetId": "@1fe/bathtub",
    "version": "<version uploaded to CDN>"
  },
  {
    "widgetId": "@1fe/widget-starter-kit",
    "version": "<version uploaded to CDN>"
  }
]
```

###### Update live.json

The [`live.json`](https://1fe-a.akamaihd.net/integration/configs/live.json) file contains the runtime configuration for the plugins that are being loaded

<div className="prose">
1. Locate `integration/configs/live.json` within your forked mock-cdn-assets repository and make the following changes:

2. Update the basePrefix to point to your jsdelivr cdn

3. Remove the `sample-widget` and `sample-widget-with-auth` widget configurations as they are not needed for this example.

Following is what the diff will look like. Also, here is a [PR](https://github.com/docusign/mock-cdn-assets/pull/28/files) showcasing these changes

```diff title="live.json"
{
+ "libraries": {
+   "basePrefix": "https://cdn.jsdelivr.net/gh/<your-github-username>/mock-cdn-assets/development/libs/"
+ },
  "widgets": {
+   "basePrefix": "https://cdn.jsdelivr.net/gh/<your-github-username>/mock-cdn-assets/development/widgets/",
    "configs": [
      {
        "widgetId": "@1fe/bathtub",
        "plugin": {
          "enabled": true,
          "route": "/widget-starter-kit"
        }
      },
-     {
-       "widgetId": "@1fe/sample-widget",
-       "plugin": {
-         "enabled": true,
-         "route": "/sample-widget"
-       }
-     },
-     {
-       "widgetId": "@1fe/sample-widget-with-auth",
-       "plugin": {
-         "enabled": true,
-         "route": "/sample-widget-with-auth",
-         "auth": {
-           "authenticationType": "required"
-         }
-       }
-     }
    ]
  }
}
```

4. Push these changes to your forked repository. Create and push a tag. This is important for JSdelivr to cache the assets properly.
```
git tag v1.0.3
git push origin v1.0.3
```
5. Confirm that the updated Live Configurations is reflected on jsdelivr:
```
https://cdn.jsdelivr.net/gh/<your-github-username>/<repo-name>@<tag>/integration/configs/live.json
```
</div>

An example URL would look like this:
```
https://cdn.jsdelivr.net/gh/mohit-test-org/1fe-mock-cdn-assets@v1.0.2/integration/widgets/@1fe/bathtub/1.0.50/js/1fe-bundle.js
```

:::tip
**Is jsdelivr not reflecting your changes?**

Try purging the cache here: https://www.jsdelivr.com/tools/purge. This may take a few minutes to apply.
:::

Read more about [Live Configurations](../../main-concepts/live-configurations).

##### 4. Point your local 1FE app to the new CDN assets

```tsx title="src/config/ecosystem-configs.ts" {4,7,10}
// ...
export const configManagement: OneFEConfigManagement = {
  widgetVersions: {
    url: `https://cdn.jsdelivr.net/gh/<your-github-username>/<repo-name>@<tag>/integration/configs/widget-versions.json`,
  },
  libraryVersions: {
    url: `https://cdn.jsdelivr.net/gh/<your-github-username>/<repo-name>@<tag>/integration/configs/lib-versions.json`,
  },
  dynamicConfigs: {
    url: `https://cdn.jsdelivr.net/gh/<your-github-username>/<repo-name>@<tag>/integration/configs/live.json`,
  },
  refreshMs: 30 * 1000,
};
```
:::note[ðŸ”’ CSP Gone Wrong!]
**Whoops! Page reload causing CSP issues?** 

If you refresh the page and see Content Security Policy errors blocking you from loading assets from jsdeliver, don't panic! ðŸš¨ 

You need to update the CSP settings in the 1FE app(`src/csp-configs.ts`) to allow jsdeliver(`https://cdn.jsdelivr.net/`).
:::
Navigate to [starter kit locally](http://localhost:3001/widget-starter-kit/utils) and check the console for the message "Hello from app1!" to confirm that your changes are being reflected.

##### <FcOk style={{ display: 'inline', marginRight: '0.5rem', verticalAlign: 'middle' }} /> Tada!

![A rocketship in space](./assets/example-plugin-change.png)

:::note
**In an ideal-state:**
- There should be proper CDN hosting for Live Configurations and widget assets.
- Each widget should live in their own repository.
- Each widget should own CI/CD pipelines that upload assets to CDN and bump release versions on merge. 

Follow the guide [here](../../platform-guides/productionize) to productionize your 1FE app.
:::
